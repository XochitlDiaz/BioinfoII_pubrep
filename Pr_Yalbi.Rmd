---
title: "Practica 4"
author: "J. Rojas, X. Díaz"
date: "3/7/2022"
output: 
  html_document:
    toc: yes
  pdf_document:
    toc: yes
  word_document:
    toc: yes
editor_options: 
  markdown: 
    wrap: 72
---

Git hub project: <https://github.com/XochitlDiaz/BioifoII_pubrep>

#Save Rhistory
history(max.show = Inf, reverse = T)




# Cluster Usage

```{r, eval=FALSE}
module load kallisto/0.45.0
module load sra/2.9.6-1
module load r/4.0.2

```

# Data Description

Data was obtained by using the sra package and the respective accesion list found in it's GEO Dataset. Our SRA Accession is: GSE185492. This was found by running a search in th NCBI Databse and then sending the selected files to the SRA Run Selector to generate an accession list.

The data itself was generated by RNA-seq of control and treated mice. The goal of this study was to the investigate the hepatic effects of lactational deliver of Triclosan in neonatal mice. The treatment group was Triclosan treated mice via milk ingest and it's respective control group (N=3/group).

In this study, DE analysis was performed to identify the transcriptomic profile of the control and treatment group.


## All commands in R

```{bash, eval=FALSE}
cd /mnt/Timina/bioinfoII/XJS/Yalbi/kallisto
module load r/4.0.2
R

(In R)
> library(tximport)
> library(tidyverse)
> files <- file.path("/mnt/Timina/bioinfoII/XJS/Yalbi/kallisto", list.dirs(), "abundance.h5") 
> names(files) <- str_extract(files,"SRR\\d+")
> files = files[2:7]


# Load table with trx id and gene id corrspondence
tx2gene <- read.csv("/mnt/Timina/bioinfoII/rnaseq/resources/gencode/gencode.vM28.basic.trx_id-gene_id-no_ver.tsv",stringsAsFactors = F)
# Load table with trx id and gene name correspondence
tx2genename <- read.csv("/mnt/Timina/bioinfoII/rnaseq/resources/gencode/gencode.vM28.basic.trx_id-gene_name-no_ver.tsv",stringsAsFactors = F)

txi.kallisto <- tximport(files, type = "kallisto", tx2gene = tx2gene, ignoreAfterBar=TRUE, ignoreTxVersion=TRUE)
txi.kallisto.name <- tximport(files, type = "kallisto", tx2gene = tx2genename, ignoreAfterBar=TRUE, ignoreTxVersion=TRUE)

> library(DESeq2)
samples <- read.csv("/mnt/Timina/bioinfoII/XJS/Yalbi/SraRunTable.txt",stringsAsFactors = F, header = TRUE)
samples <- column_to_rownames(samples, var = "Run")

dds <- DESeqDataSetFromTximport(txi.kallisto,colData = samples,design = ~ treatment)
#dds$treatment <- factor(dds$treatment, levels = c("TCS breastmilk","Regular breastmilk"))

keep <- rowSums(counts(dds)) >= 6
dds <- dds[keep, ]
dds$treatment <- factor(dds$treatment, levels = c("TCS breastmilk","Regular breastmilk"))
dds <- DESeq(dds)
res <- results(dds)

de <- as.data.frame(res)
de$diffexpressed <- "NO"
de$diffexpressed[de$log2FoldChange > 1 & de$pvalue < 0.01] <- "UP"
de$diffexpressed[de$log2FoldChange < -1 & de$pvalue < 0.01] <- "DOWN"

library(ggrepel)
de$names <- NA
filter <- which(de$diffexpressed != "NO" & de$padj < 0.01 & (de$log2FoldChange > 1 | de$log2FoldChange < -1)) #<<
de$names[filter] <- rownames(de)[filter] #<<

res.05 <- results(dds, alpha = 0.05)
table(res.05$padj < 0.05)

resLFC1 <- results(dds, lfcThreshold=1)
table(resLFC1$padj < 0.1)



outdir = "/mnt/Timina/bioinfoII/XJS/Yalbi/kallisto/Results/"
png(file = paste0(outdir,"volcano_plot.png"),
    width = 800, height = 800) #

ggplot(data=de, aes(x=log2FoldChange, y=-log10(pvalue), col=diffexpressed, label=names)) + #<<
    geom_point() +
  geom_point(x=0.305969,y=1.337297875,col="green") +
    scale_color_manual(values=c("blue", "black", "red")) + #change dot colour #<<
    theme_minimal() +
    geom_text_repel() + #<<
    xlim(-15,15)


## For filtered data
png(file = paste0(outdir,"volcano_filt.png"),
    width = 800, height = 800)    
ggplot(data=deLFC1, aes(x=log2FoldChange, y=-log10(pvalue), col=diffexpressed, label=names)) + #<<
    geom_point() +
  geom_point(x=0.305969,y=1.337297875,col="green") +
    scale_color_manual(values=c("blue", "black", "red")) + #change dot colour #<<
    theme_minimal() +
    geom_text_repel() + #<<
    xlim(-15,15)

dev.off()


library(gprofiler2)
resSig <- subset(res, padj < 0.1 & log2FoldChange > 1)
resSig <- resSig[ order(resSig$log2FoldChange, decreasing = TRUE), ]
DEG <- rownames(resSig)
genes_universe <- rownames(dds)

# enrichment analysis
gostres = gost(query = DEG, organism = "mmusculus", significant = T, 
               correction_method = "fdr", domain_scope = "custom", 
               custom_bg = genes_universe, ordered_query = TRUE)
names(gostres)
attributes(gostres$meta)
head(gostres$result)


library(forcats)
outdir = "/mnt/Timina/bioinfoII/XJS/Yalbi/kallisto/Results/"
go <- as.data.frame(gostres$result)

png(file = paste0(outdir,"gost01-resSig.png"),
    width = 800, height = 800) # guardar el plot en formato png
# Reorder following the value of another column:
library(ggplot2)
library(dplyr)
go %>%
  dplyr::slice(1:20) %>%
  select(p_value, term_name) %>%
  mutate(go = fct_reorder(term_name, p_value)) %>%
  ggplot( aes(x=go, y=p_value)) +
    geom_bar(stat="identity", fill="#3A68AE", alpha=.6, width=.4) +
    coord_flip() +
    labs(x = "", y = "Adjusted P-value") +
    theme_bw(base_size = 20)

dev.off()

```

```{r,eval=F}
####More filters

#Lower the false discovery rate threshold (the threshold on `padj` in the results table)


res.05 <- results(dds, alpha = 0.05)
table(res.05$padj < 0.05) # genes that rejected null hypothesis
summary(res.05)
# Raise the log2 fold change threshold from 0 using the `lfcThreshold` argument of results
# test for genes that show more substantial changes due to treatment
# `lfcThreshold = 1`, we test for genes that show significant effects of treatment on gene counts more than doubling or less than halving, because 2^1=2

resLFC1 <- results(dds, lfcThreshold=1)
table(resLFC1$padj < 0.1)
```

## Data Download

<h3> Commands </h3>

    scp <storage_dir>/SRR_Acc_List.txt crojas@dna.lavis.unam.mx:´<cluster_dir>/SRR_Acc_List.txt
    xargs fastq-dump <SRR_Acc_List.txt
    scp <storage_dir>/SraRunTable.txt crojas@dna.lavis.unam.mx:´<cluster_dir>/SraRunTable.txt

<h3> Explanation </h3>

To download the data, we first generated an accesion list containing only the replicas used in this report. The aforementioned accesion list was then uploaded to our server using the scp command.
Finally, to download all the files contained in the accession list, the fastq-dump command was used. To run the command for every file contained in our accession list, the expression: "<SRR_Acc_List.txt" was employed.
We also downloaded the associated metadata, since it will come in handy both for understanding the treatment status of each sample and to tag each simple in our differential expression analysis.

# RNA-seq Pipeline


## Quality Control

After checking the metadata and data description of our reads, we realized that they had already been filtered and set to the same length. Therefore, it was no longer necessary to perform any clipping or filtering.

## Indexing

### Download Reference Transcriptome

<h3>

Commands

</h3>

```{r, eval=FALSE}
wget https://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_mouse/release_M29/gencode.vM29.transcripts.fa.gz
```

<h3>

Explanation

</h3>

The wget command allows us to download a file by providing the file URL
from a public available server. We downloaded the full Mouse transcriptome from the GENCODE webpage.

## Kallisto Indexing

<h3>
Commands
</h3>

```{r, eval=FALSE}
kallisto index -i index_gencode_v39_transcripts gencode.v39.transcripts.fa.gz
```

<h3>
Explanation
</h3>

This command helps us index our transcriptome reference file. The -i
parameter is used to determine the output of our indexed transcriptome. This will allow us to perform kallisto quantification much faster and efficiently.

## Quantification

### Obtain Paramaters

<h3> Commands </h3>

```{r, eval=FALSE}
awk 'BEGIN { t=0.0;sq=0.0; n=0;} ;NR%4==2 {n++;L=length($0);t+=L;sq+=L*L;}END{m=t/n;printf("total %d avg=%f stddev=%f\n",n,m,sq/n-m*m);}' SRR18735738.fastq
awk 'BEGIN { t=0.0;sq=0.0; n=0;} ;NR%4==2 {n++;L=length($0);t+=L;sq+=L*L;}END{m=t/n;printf("total %d avg=%f stddev=%f\n",n,m,sq/n-m*m);}' SRR18735739.fastq
awk 'BEGIN { t=0.0;sq=0.0; n=0;} ;NR%4==2 {n++;L=length($0);t+=L;sq+=L*L;}END{m=t/n;printf("total %d avg=%f stddev=%f\n",n,m,sq/n-m*m);}' SRR18735740.fastq
awk 'BEGIN { t=0.0;sq=0.0; n=0;} ;NR%4==2 {n++;L=length($0);t+=L;sq+=L*L;}END{m=t/n;printf("total %d avg=%f stddev=%f\n",n,m,sq/n-m*m);}' SRR18735741.fastq
awk 'BEGIN { t=0.0;sq=0.0; n=0;} ;NR%4==2 {n++;L=length($0);t+=L;sq+=L*L;}END{m=t/n;printf("total %d avg=%f stddev=%f\n",n,m,sq/n-m*m);}' SRR18735742.fastq
awk 'BEGIN { t=0.0;sq=0.0; n=0;} ;NR%4==2 {n++;L=length($0);t+=L;sq+=L*L;}END{m=t/n;printf("total %d avg=%f stddev=%f\n",n,m,sq/n-m*m);}' SRR18735743.fastq
```

<h3>
Explanation
</h3>

Since our data is presented as single-read ends, we must specify the
average length and standard deviation for each of our sequenced group of
reads. To do this we used the regular awk command to obtain the
aforementioned information. Then we used this output to run quantification
with kallisto.

### Kallisto Quantification

<h3>
Commands
</h3>

```{r,eval=FALSE}
mkdir <each sample name>
kallisto quant -i /mnt/Timina/bioinfoII/crojas/RNA/gencode_index -o ./SRR18735738 ../sra/SRR18735738.fastq --single -l 100.00000 -s 0.00001
kallisto quant -i /mnt/Timina/bioinfoII/crojas/RNA/gencode_index -o ./SRR18735739 ../sra/SRR18735739.fastq --single -l 100.00000 -s 0.00001
kallisto quant -i /mnt/Timina/bioinfoII/crojas/RNA/gencode_index -o ./SRR18735740 ../sra/SRR18735740.fastq --single -l 100.00000 -s 0.00001
kallisto quant -i /mnt/Timina/bioinfoII/crojas/RNA/gencode_index -o ./SRR18735741 ../sra/SRR18735741.fastq --single -l 100.00000 -s 0.00001
kallisto quant -i /mnt/Timina/bioinfoII/crojas/RNA/gencode_index -o ./SRR18735742 ../sra/SRR18735742.fastq --single -l 100.00000 -s 0.00001
kallisto quant -i /mnt/Timina/bioinfoII/crojas/RNA/gencode_index -o ./SRR18735743 ../sra/SRR18735743.fastq --single -l 100.00000 -s 0.00001
```

<h3>
Explanation
</h3>

Since kallisto quant command produces its output into directories for
each of the test file's name, first we created directories to fit this
requirement, then we ran the specified commands in an sge file.

The parameter (-i) in kallisto quant is used to specify the route and
name of our index files.\
The -o parameter is used to specify the output directory for each of the
fastq files being quantified. Since these are single end reads, we must
specify this with the flag "--single". The -l and -s parameters are used
to specify mean fragment length and standard deviation for each file.
Finally, we provide the command with each of the files we will quantify.

## Normalization

### Batch effect correction

Since all of the samples were sequenced in the same batch, there shouldn't
be any bias driven by variation in the sequencing batches. Therefore, it was not necessary to undergo batch effect correction.

### DESeq2 

Because we want to make differential expression analysis
through RNA composition comparison between the samples of the
experiment, we used DESeq2's normalization, given that it is an
appropriate method for the data we are using.

<h3>
Commands
</h3>

```{r,eval=FALSE}

cd /mnt/Timina/bioinfoII/XJS/Yalbi/kallisto
module load r/4.0.2
R

(In R)
library(tximport)
library(tidyverse)
files <- file.path("/mnt/Timina/bioinfoII/XJS/Yalbi/kallisto", list.dirs(), "abundance.h5") 
names(files) <- str_extract(files,"SRR\\d+")
files = files[2:7]

# Load table with trx id and gene id corrspondence
tx2gene <- read.csv("/mnt/Timina/bioinfoII/rnaseq/resources/gencode/gencode.vM28.basic.trx_id-gene_id-no_ver.tsv",stringsAsFactors = F)
# Load table with trx id and gene name correspondence
tx2genename <- read.csv("/mnt/Timina/bioinfoII/rnaseq/resources/gencode/gencode.vM28.basic.trx_id-gene_name-no_ver.tsv",stringsAsFactors = F)

txi.kallisto <- tximport(files, type = "kallisto", tx2gene = tx2gene, ignoreAfterBar=TRUE, ignoreTxVersion=TRUE)
txi.kallisto.name <- tximport(files, type = "kallisto", tx2gene = tx2genename, ignoreAfterBar=TRUE, ignoreTxVersion=TRUE)

> library(DESeq2)
samples <- read.csv("/mnt/Timina/bioinfoII/XJS/Yalbi/SraRunTable.txt",stringsAsFactors = F, header = TRUE)
samples <- column_to_rownames(samples, var = "Run")

dds <- DESeqDataSetFromTximport(txi.kallisto,colData = samples,design = ~ treatment)

keep <- rowSums(counts(dds)) >= 6
dds <- dds[keep, ]
dds$treatment <- factor(dds$treatment, levels = c("TCS breastmilk","Regular breastmilk"))
dds <- DESeq(dds)
res <- results(dds)
```

<h3>
Explanation
</h3>

First we loaded R 4.0.2 in our working environment, then we opened R
form the cluster terminal to run the code shown above. It is important
to mention that to run the code we generated the R working environment
at the working directory where we saved the output of kallisto
quantification.

First we used tximport to integrate the transcript data of our 6
samples in a matrix with Mus Musculus genes. We used version 39 of the
genome for this data integration.

To integrate the metadata of our samples in order to make indicate
sample groups (condition groups) we loaded the metadata file onto our R environment and then extracted the appropiate columns that associate treatment group with sample name.


For the DESeq2 Data Set construction we use our tximport output matrix
and indicate that that condition column has the group variables. After
the the statistical modeling we filtered genes that had counts lower or
equal to zero. Then we apply the Differential expression analysis with
DESeq() function and finally we apply the results() function to see the
log 2 fold change analysis in both groups (TCS breastmilk and Regular breastmilk).


## Reducing significant DE genes

<h3> Commands </h3>

```{r}

de <- as.data.frame(res)
de$diffexpressed <- "NO"
de$diffexpressed[de$log2FoldChange > 1 & de$pvalue < 0.01] <- "UP"
de$diffexpressed[de$log2FoldChange < -1 & de$pvalue < 0.01] <- "DOWN"

library(ggrepel)
de$names <- NA
filter <- which(de$diffexpressed != "NO" & de$padj < 0.01 & (de$log2FoldChange > 1 | de$log2FoldChange < -1)) #<<
de$names[filter] <- rownames(de)[filter] #<<

res.05 <- results(dds, alpha = 0.05)
table(res.05$padj < 0.05)

resLFC1 <- results(dds, lfcThreshold=1)
table(resLFC1$padj < 0.1)

```


<h3> Explanation </h3>

Since the DE Analysis produced a large collection of differentially expressed genes, we decided to narrow our search in order to find a more informative subset of genes. To do this, we added another column in our matrix to classify genes according to whether we consider them as differentially expressed or not. 
Then, we conducted filtering in two ways: 

1. By assesing log fold change 
  + We set our new filtered selection to admit genes with a higher absolute value than 1
2. By setting a lower adjusted p-value threshold
  + Genes with an adj. p-value lower than 0.05
  + Genes with an adj. p-value lower than 0.01 (This became our final collection)

----------Current progress -------------

# Results

<h3>
Volcano plot
</h3>

![](./volcano-res.png) Shows the overall differentially expressed genes
in shRUNX1 sample cell cultures using as base line shNS sample cell
cultures. Overexpressed genes are shown in red. Underexpressed genes are
show in blue. Genes that where not significantly over or under expressed
are shown in gray.

The most deferentially expressed genes are labeled. In the literature we
found that these genes are prognostic markers in various types of
cancer. (Ref8:Ref13)

It is especially interesting that ENSG000001456325 is highly
underexpressed given that it is a tumor suppressor. (Ref14)

<h4>

Code to make the plot

</h4>

```{r, eval=FALSE}
# Add a column to the data frame to specify if they are UP- or DOWN- regulated (log2FoldChange respectively positive or negative)
de <- as.data.frame(res)

# add a column of NAs
de$diffexpressed <- "NO"
# if log2Foldchange > 1 and pvalue < 0.01, set as "UP" 
de$diffexpressed[de$log2FoldChange > 1 & de$pvalue < 0.01] <- "UP"
# if log2Foldchange < -1 and pvalue < 0.01, set as "DOWN"
de$diffexpressed[de$log2FoldChange < -1 & de$pvalue < 0.01] <- "DOWN"

#This library avoids lable overlap in plots
library(ggrepel)

# Create a new column "names" to de, that will contain the name of a subset if genes differentially expressed (NA in case they are not)
de$names <- NA
# filter for a subset of interesting genes
filter <- which(de$diffexpressed != "NO" & de$padj < 0.01 & (de$log2FoldChange > 1 | de$log2FoldChange < -1)) #<<
de$names[filter] <- rownames(de)[filter] #<<

####More filters

#Lower the false discovery rate threshold (the threshold on `padj` in the results table)


res.05 <- results(dds, alpha = 0.05)
table(res.05$padj < 0.05) # genes that rejected null hypothesis
summary(res.05)
# Raise the log2 fold change threshold from 0 using the `lfcThreshold` argument of results
# test for genes that show more substantial changes due to treatment
# `lfcThreshold = 1`, we test for genes that show significant effects of treatment on gene counts more than doubling or less than halving, because 2^1=2

resLFC1 <- results(dds, lfcThreshold=1)
table(resLFC1$padj < 0.1)




# Generate and save plot
#save plot as png
outdir = "/mnt/Timina/bioinfoII/XJS/Yalbi/kallisto/Results"
png(file = paste0(outdir,"volcano_filter.png"), width = 800, height = 800) 
ggplot(data=de, aes(x=log2FoldChange, y=-log10(pvalue), col=diffexpressed, label=names)) + #<<
    geom_point() +
  geom_point(x=0.305969,y=1.337297875,col="green") +
    scale_color_manual(values=c("blue", "black", "red")) + #change dot colour #<<
    theme_minimal() +
    geom_text_repel() + #<<
    xlim(-15,15)

dev.off()
```


Filtered plot

```{r, eval=FALSE}
# Add a column to the data frame to specify if they are UP- or DOWN- regulated (log2FoldChange respectively positive or negative)
deLFC1 <- as.data.frame(resLFC1)

# add a column of NAs
de$diffexpressed <- "NO"
# if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP" 
de$diffexpressed[de$log2FoldChange > 0.6 & de$pvalue < 0.05] <- "UP"
# if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN"
de$diffexpressed[de$log2FoldChange < -0.6 & de$pvalue < 0.05] <- "DOWN"

png(file = paste0(outdir,"volcano04-res.png"),
    width = 800, height = 800) # guardar el plot en formato png

ggplot(data=de, aes(x=log2FoldChange, y=-log10(pvalue), col=diffexpressed)) + # cambiamos col param de aes #<<
  geom_point() + theme_minimal() + 
  geom_vline(xintercept=c(-0.6, 0.6), col="red") +
  geom_hline(yintercept=-log10(0.05), col="red") +
  xlim(-15,15)

dev.off()
```








<h3>

Functional Analysis

</h3>

We used Gprofilter to make a gene ontology enrichment analysis to
evaluate whether the results of our differential expression analysis
make sense or not.

![Go - over expressed](./gost01-resSig.png) Gene ontology enrichment
analysis of overexpressed genes in shRUNX1 samples: From this figure we
see a significant overexpression of H2AX complex II, which makes sense
in the context of RUNX1 oncogenic mutant given that we previously knew
RUNX1 is associated with genome organization. Searching in the
literature we found H2AX is an H2A histone variant group (ref 2) found
in response to DNA damage, so it makes sense finding it overexpressed in
presence of an activated oncogene because these often lead to more
mutations and DNA damage to which the cell would most likely be trying
to repair. To further understand if this overexpression of H2AX is a
direct cause of RUNX1 mutant or if it's a factor that leads to RUNX1
mutant we would have to make a more ditailed analysis of the literature
or even some experiments, which overpass the purpose of this assay.

![Go - underexpressed](./gost02-resSig.png) Gene ontology enrichment
analysis of underexpressed genes in shRUNX1 samples. Searching in the
literature we found that many of the genes that are significantly
under-expressed are related to extra cellular matrix signaling
components, which may explain why the immunity system fails to recognize
the oncogenic cell in order to kill it. Gene - function relation
(Ref3:Ref7)

-   TGFβ1, TGFβ2, and TGFβ3 : play an essential role in cellular
    signaling and ECM remodeling.

-   PLXNA4 : Signaling for cytoskeleton remodeling

-   MMP14 and MMP2 : Breakdown of extracellular matrix.

-   CLDN1 : Cell - cell spatial interactions.

<h4>

Code to make the plots

</h4>

```{r,eval=FALSE}
library(ggrepel)
library(gprofiler2)

# For down-regulated genes

# subset results for genes of interest
resSig <- subset(res, padj < 0.01 & log2FoldChange < -1) # subset
resSig <- resSig[ order(resSig$log2FoldChange, decreasing = TRUE), ]

# define gene lists
DEG <- rownames(resSig)
genes_universe <- rownames(dds)

# enrichment analysis
gostres = gost(query = DEG, organism = "hsapiens", significant = T, 
               correction_method = "fdr", domain_scope = "custom", 
               custom_bg = genes_universe, ordered_query = TRUE)
               
library(forcats)
library(ggplot2)

outdir = "/mnt/Timina/bioinfoII/squinones/RNA-seq/RNA_MONI/"
go <- as.data.frame(gostres$result)

png(file = paste0(outdir,"gost02-resSig.png"),
    width = 1800, height = 800) # guardar el plot en formato png
# Reorder following the value of another column:
go %>%
  dplyr::slice(1:15) %>%
  select(p_value, term_name) %>%
  mutate(go = fct_reorder(term_name, p_value)) %>%
  ggplot( aes(x=go, y=p_value)) +
  geom_bar(stat="identity", fill="#3A68AE", alpha=.6, width=.4) +
  coord_flip() +
  labs(x = "", y = "Adjusted P-value") +
  theme_bw(base_size = 20)

dev.off()

# For up-regulated genes

# subset results for genes of interest
resSig <- subset(res, padj < 0.01 & log2FoldChange > 1) # subset
resSig <- resSig[ order(resSig$log2FoldChange, decreasing = TRUE), ]

# define gene lists
DEG <- rownames(resSig)
genes_universe <- rownames(dds)

# enrichment analysis
gostres = gost(query = DEG, organism = "hsapiens", significant = T, 
               correction_method = "fdr", domain_scope = "custom", 
               custom_bg = genes_universe, ordered_query = TRUE)
               
library(forcats)
library(ggplot2)

outdir = "/mnt/Timina/bioinfoII/squinones/RNA-seq/RNA_MONI/"
go <- as.data.frame(gostres$result)

png(file = paste0(outdir,"gost02-resSig.png"),
    width = 1800, height = 800) # guardar el plot en formato png
# Reorder following the value of another column:
go %>%
  dplyr::slice(1:15) %>%
  select(p_value, term_name) %>%
  mutate(go = fct_reorder(term_name, p_value)) %>%
  ggplot( aes(x=go, y=p_value)) +
  geom_bar(stat="identity", fill="#3A68AE", alpha=.6, width=.4) +
  coord_flip() +
  labs(x = "", y = "Adjusted P-value") +
  theme_bw(base_size = 20)

dev.off()
```

# References

* Geo Dataset: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE200705

* SRA Run Selector: https://www.ncbi.nlm.nih.gov/Traces/study/?acc=PRJNA826106&o=acc_s%3Aa

Ref1: Mónica Padilla 2022, *RNA-seq Bioinformática - LCG-EJ*, Git Hub,
viewed 10 March 2022,
<https://github.com/mpadilla905/clase_RNA-seq_LCGEJ2022.git>

Ref2: Uni Prot , *UniProtKB - P16104 (H2AX_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/P16104>

Ref3:Uni Prot , *UniProtKB - P36897 (TGFR1_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/P36897>

Ref4:Wikipedia, *Receptores de TGF-beta* , Wikipedia
<https://es.wikipedia.org/wiki/Receptores_de_TGF-beta>

Ref5:Uni Prot , *UniProtKB - Q9HCM2 (PLXA4_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/Q9HCM2>

Ref5:Uni Prot , *UniProtKB - P50281 (MMP14_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/P50281>

Ref6:Uni Prot , *UniProtKB - P08253 (MMP2_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/P08253>

Ref7:Uni Prot , *UniProtKB - O95832 (CLD1_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/O95832>

Ref8:Uni Prot , *UniProtKB - P16949 (STMN1_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/P16949>

Ref9:Uni Prot , *UniProtKB - P68431 (H31_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/P68431>

Ref10:Uni Prot , *UniProtKB - Q9NQW6 (ANLN_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/Q9NQW6>

Ref11:Uni Prot , *UniProtKB - P06280 (AGAL_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/P06280>

Ref12:Wikipedia, *HIST1H3C* , Wikipedia
<https://en.wikipedia.org/wiki/HIST1H3C>

Ref13:Uni Prot , *UniProtKB - Q8IZT6 (ASPM_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/Q8IZT6>

Ref14:Uni Prot , *UniProtKB - Q9NYY3 (PLK2_HUMAN)* , Uni Prot,
<https://www.uniprot.org/uniprot/Q9NYY3>

Ref15: Pacher Lab, *Kallisto -Maual*, Pacher Lab,
<https://pachterlab.github.io/kallisto/manual>

Ref16: USADELLAB, *Trimmomatic: A flexible read trimming tool for
Illumina NGS data*, USADELLAB ORG,
<http://www.usadellab.org/cms/?page=trimmomatic>

Ref17: MultiQC, *Using MultiQC*, MultiQC Docs,
<https://multiqc.info/docs/>

Ref18: Bioconductor, *Package 'taximport'*, Bioconductor,
<https://bioconductor.org/packages/devel/bioc/manuals/tximport/man/tximport.pdf>
